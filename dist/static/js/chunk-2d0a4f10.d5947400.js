(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4f10"],{"091b":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui container padding"},[t.contest_mode?n("contest-mode"):t._e(),t.contest_mode?t._e():n("h2",{staticClass:"ui dividing header"},t._l(t.header,(function(e,s){return n("router-link",{key:s,attrs:{to:"/contest/problem/"+e}},[t._v(t._s(e)+" ")])})),1),n("div",{staticClass:"ui grid"},[n("div",{staticClass:"fourteen wide column"},[n("div",{staticClass:"ui fluid multiple search selection dropdown"},[n("input",{attrs:{type:"hidden",name:"country"},domProps:{value:t.contest_id_raw},on:{change:function(e){t.select2=e.target.value}}}),n("i",{staticClass:"dropdown icon"}),n("div",{staticClass:"default text"},[t._v("Select Contest Or Input Contest ID")]),n("div",{staticClass:"menu"},t._l(t.contest_list,(function(e,s){return n("div",{key:s,staticClass:"item",attrs:{"data-value":e.contest_id,title:e.title}},[t._v(t._s("Contest"+e.contest_id+" "+e.title))])})),0)])]),n("div",{staticClass:"two wide column"},[n("a",{staticClass:"primary button ui",on:{click:function(e){return t.run(2)}}},[t._v("Go")])])]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"ui segment"},[n("h2",{staticClass:"ui header"},[t._v("加载中")])]),n("div",{staticClass:"ui segment"},[n("div",{staticClass:"ui container",staticStyle:{padding:"1em"}},[n("div",{staticClass:"ui labeled input"},[n("div",{staticClass:"ui label"},[t._v(" 柱状数 ")]),n("input",{attrs:{type:"text",placeholder:"10"},on:{change:function(e){t.row_count=parseInt(e.target.value)}}})]),n("div",{staticClass:"ui labeled input"},[n("div",{staticClass:"ui label"},[t._v(" 大于等于 ")]),n("input",{attrs:{type:"text",placeholder:""},on:{change:function(e){t.greater=e.target.value}}})]),n("div",{staticClass:"ui labeled input"},[n("div",{staticClass:"ui label"},[t._v(" 小于等于 ")]),n("input",{attrs:{type:"text",placeholder:""},on:{change:function(e){t.lower=e.target.value}}})]),n("a",{staticClass:"ui primary button"},[t._v("应用")])]),n("div",{staticStyle:{height:"500px"},attrs:{id:"chartdiv"}})]),n("div",{staticClass:"ui grid"},[n("div",{staticClass:"row"},[n("table",{staticClass:"ui table"},[n("thead",[n("tr",[n("th",{on:{click:function(e){return t.sort(1)}}},[n("a",[n("i",{directives:[{name:"show",rawName:"v-show",value:1==t.type,expression:"type == 1"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("User ID")])]),n("th",{on:{click:function(e){return t.sort(2)}}},[n("a",[n("i",{directives:[{name:"show",rawName:"v-show",value:2==t.type,expression:"type == 2"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("Nick")])]),n("th",[n("a",{on:{click:function(e){return t.sort(3)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:3==t.type,expression:"type == 3"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("通过")])]),n("th",[n("a",{on:{click:function(e){return t.sort(4)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:4==t.type,expression:"type == 4"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("总提交")])]),n("th",[n("a",{on:{click:function(e){return t.sort(5)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:5==t.type,expression:"type == 5"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("平均代码行数")])]),n("th",[n("a",{on:{click:function(e){return t.sort(6)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:6==t.type,expression:"type == 6"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("平均代码长度")])]),n("th",[n("a",{on:{click:function(e){return t.sort(7)}}},[n("i",{directives:[{name:"show",rawName:"v-show",value:7==t.type,expression:"type == 7"}],class:"sort numeric icon "+(t.order>0?"down":"up")}),t._v("总代码长度 ")])])])]),n("tbody",t._l(t.status_data,(function(e,s){return n("tr",{key:s},[n("td",[n("router-link",{attrs:{to:"/user/"+e.user_id},domProps:{innerHTML:t._s(e.user_id)}})],1),n("td",[n("router-link",{attrs:{to:"/user/"+e.user_id},domProps:{innerHTML:t._s(e.nick)}})],1),n("td",{domProps:{innerHTML:t._s(e.ac.size)}}),n("td",{domProps:{innerHTML:t._s(e.submit.size)}}),n("td",{domProps:{innerHTML:t._s(e.average_line)}}),n("td",{domProps:{innerHTML:t._s(e.average_length+"B")}}),n("td",{domProps:{innerHTML:t._s(e.total_line)}})])})),0)])])])],1)},i=[],r=(n("e260"),n("26e9"),n("4e82"),n("e6cf"),n("2532"),n("1276"),n("ddb0"),n("9ab4")),a=n("2cd4"),o=n("71c9"),c=n("c497"),u=n("2ef0"),d=n.n(u),l=n("1157"),h=n.n(l),p=n("60a3");const _=h.a,g=n("5a54").default;function v(t,e=10){e=Math.max(e,1),o["e"](g);const n=o["d"]("chartdiv",c["j"]);n.hiddenState.properties.opacity=0;const s=t[0],i=t[t.length-1],r=Math.trunc((s-i)/e);let a=s-r,u=[];for(let o=0;o<e-1;++o)u.push({part:a+"-"+(a+r),count:0}),a-=r;u.push({part:i+"-"+(a+r),count:0}),a=s-r;let l=0,h=0;d.a.forEach(t,(function(t){if(t>=a)++u[l].count;else try{u.length-1>l?(++u[++l].count,a-=r):++u[l].count}catch(e){console.log("cnt",l),console.log("val",t)}h=Math.max(h,u[l].count)})),u=u.reverse(),n.data=u;const p=n.xAxes.push(new c["a"]);p.renderer.grid.template.location=0,p.dataFields.category="part",p.renderer.minGridDistance=40,p.fontSize=11;const _=n.yAxes.push(new c["i"]);_.min=0,_.max=h,_.strictMinMax=!0,_.renderer.minGridDistance=30;const v=n.series.push(new c["d"]);v.dataFields.categoryX="part",v.dataFields.valueY="count",v.columns.template.tooltipText="{valueY.value}",v.columns.template.tooltipY=0,v.columns.template.strokeOpacity=0,v.columns.template.adapter.add("fill",(function(t,e){return n.colors.getIndex(e.dataItem.index)}))}let m=class extends(Object(p["b"])(a["a"])){constructor(){super(...arguments),this.cidArray=[],this.contest_mode=!1,this.raw_data=[],this.header=[],this.contest_id_raw="",this.status_data=[],this.data_set=[],this.order=1,this.contest_list=[],this.select1="",this.select2="",this.type=1,this.row_count=10,this.lower="",this.greater="",this.ranged=!1,this.loading=!1}created(){let t=this.$route.params.contest_id;this.contest_id_raw=this.$route.params.contest_id,t&&t.length&&(t=t.split(",")),this.header=t,this.cidArray=t}onRowCountChanged(t,e){t!==e&&(!1===!!t&&(t=10),v(this.data_set,t))}onLowerChanged(t,e){const n=this;this.$nextTick((function(){n.rangeChange()}))}onGreaterChanged(t,e){const n=this;this.$nextTick((function(){n.rangeChange()}))}onRangeChanged(t,e){if(!t){const t=this;this.$nextTick((function(){t.generate(t.raw_data)}))}}mounted(){const t=this;this.loading=!0,this.axios.get("/api/contest/list").then(e=>{const n=e.data;n.data.sort((function(t,e){return parseInt(e.contest_id)-parseInt(t.contest_id)})),t.contest_list=n.data,setTimeout((function(){_(".multiple.search").dropdown({fullTextSearch:!0})}),1e3)}),this.getData()}updatecidArrayFromSelect(){let t=this.select2;this.loading=!0,t&&t.length&&(t=t.split(",")),this.cidArray=t,this.header=t}getData(){const t=this,e=[];d.a.forEach(this.cidArray,t=>{e.push(new Promise((e,n)=>{this.axios.get(`/api/scoreboard/${t}/line`).then(({data:s})=>{"OK"==s.status?e(s.data):n(t)})}))}),Promise.all(e).then(e=>{t.raw_data=e,t.generate(e)})}sortOrder(t){const e=this.status_data,n=this.order;switch(t){case 1:e.sort((function(t,e){return n*(e.user_id>t.user_id?1:e.user_id==t.user_id?0:-1)}));break;case 2:e.sort((function(t,e){return n*(e.nick>t.nick?1:e.nick==t.nick?0:-1)}));break;case 3:e.sort((function(t,e){return n*(e.ac.size-t.ac.size)}));break;case 4:e.sort((function(t,e){return n*(e.submit.size-t.submit.size)}));break;case 6:e.sort((function(t,e){return n*(e.average_length-t.average_length)}));break;case 5:e.sort((function(t,e){return n*(e.average_line-t.average_line)}));break;case 7:e.sort((function(t,e){return n*(e.total_line-t.total_line)}));break}}sort(t){const e=this.type;this.order=e!=t?1:-this.order,this.type=t,this.sortOrder(t)}rangeChange(){if(isNaN(this.lower)&&isNaN(this.greater))this.ranged=!1;else{if(this.lower=parseInt(this.lower),0===this.lower&&(this.lower=1/0),this.greater=parseInt(this.greater),0===this.greater&&(this.greater=-1/0),this.lower<this.greater)return;this.ranged=!0}this.ranged&&this.generate(this.raw_data)}generate(t){const e=this;new Promise((function(e,n){e(t)})).then((function(t){const n=e.greater,s=e.lower;let i=[];return d.a.forEach(t,(function(t){let r=d.a.values(t.map);const a=t.user.map((function(t){return t.user_id}));if(a.length>0){const t=[];d.a.forEach(r,(function(i){if(a.includes(i.user_id)){if(e.ranged){if(isNaN(i.user_id))return;const t=parseInt(i.user_id);if(t<n||t>s)return}t.push(i)}})),r=t}i=i.concat(r)})),i})).then((function(t){const e={};return d.a.forEach(t,(function(t){"undefined"===typeof e[t.user_id]&&(e[t.user_id]={ac:new Set,submit:new Set,line:[],len:[],user_id:t.user_id,nick:t.nick,average_line:0,average_length:0,total_line:0}),4===t.result&&(e[t.user_id].ac.add(t.problem_id),e[t.user_id].line.push(t.line),e[t.user_id].len.push(t.code_length)),e[t.user_id].submit.add(t.solution_id)})),d.a.values(e)})).then((function(t){return t.sort((function(t,e){return 1*(e.user_id>t.user_id?1:e.user_id==t.user_id?0:-1)})),e.order=1,e.type=1,t})).then((function(t){return d.a.forEach(t,(function(t){0===t.line.length&&(t.line=[0]),0===t.len.length&&(t.len=[0]),t.average_line=Math.trunc(Math.round(t.line.reduce((function(t,e){return t+e}))/Math.max(1,t.line.length))),t.average_length=Math.trunc(Math.round(t.len.reduce((function(t,e){return t+e}))/Math.max(1,t.len.length))),t.total_line=t.line.reduce((function(t,e){return t+e}))})),t})).then((function(t){const n=[];return d.a.forEach(t,(function(t){n.push(t.total_line)})),n.sort((function(t,e){return e-t})),v(n,10),e.data_set=n,t})).then((function(t){e.status_data=t,e.loading=!1}))}run(t){this.updatecidArrayFromSelect(),this.getData()}};Object(r["c"])([Object(p["d"])("row_count")],m.prototype,"onRowCountChanged",null),Object(r["c"])([Object(p["d"])("lower")],m.prototype,"onLowerChanged",null),Object(r["c"])([Object(p["d"])("greater")],m.prototype,"onGreaterChanged",null),Object(r["c"])([Object(p["d"])("range")],m.prototype,"onRangeChanged",null),m=Object(r["c"])([p["a"]],m);var f=m,w=f,y=n("2877"),b=Object(y["a"])(w,s,i,!1,null,"3ff7d5ec",null);e["default"]=b.exports}}]);